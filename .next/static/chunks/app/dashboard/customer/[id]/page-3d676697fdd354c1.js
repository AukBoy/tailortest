(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{2041:(e,a,s)=>{Promise.resolve().then(s.bind(s,5603))},5603:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>eS});var t=s(5155),l=s(2617),r=s(5695),n=s(2115),d=s(285),i=s(6695),o=s(1721),c=s(8763),m=s(7223),x=s(5300),u=s(1554),p=s(1920),h=s(4301),f=s(7082),j=s(8390),N=s(9545),g=s(4843),b=s(9556),v=s(4477);let y=(0,v.createServerReference)("40d7668d13e806cc2cb8a02fd32b8c60ad111d4a33",v.callServer,void 0,v.findSourceMapURL,"getStyleRecommendation");var w=s(7832),S=s(7481);function C(e){let{customer:a}=e,[s,l]=(0,n.useState)(""),[r,o]=(0,n.useState)(!1),{toast:c}=(0,S.dj)(),m=async()=>{o(!0),l("");let e=a.measurementSets&&a.measurementSets.length>0?[...a.measurementSets].sort((e,a)=>new Date(a.date).getTime()-new Date(e.date).getTime())[0].measurements:[];if(!a.orderHistory&&!a.preferences&&0===e.length){c({title:"Not enough information",description:"Please add order history, preferences, or measurements to generate a recommendation.",variant:"destructive"}),o(!1);return}let s=e.reduce((e,a)=>(e[a.label]=a.value,e),{});try{let e=await y({measurements:s,orderHistory:a.orderHistory||"Not provided",preferences:a.preferences||"Not provided"});l(e.styleRecommendation)}catch(e){console.error(e),c({title:"AI Error",description:"Could not generate a recommendation at this time.",variant:"destructive"})}finally{o(!1)}};return(0,t.jsxs)(i.Zp,{className:"shadow-lg border-primary/20",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"font-headline text-2xl flex items-center gap-2",children:[(0,t.jsx)(w.A,{className:"text-primary"})," AI Style Recommender"]}),(0,t.jsx)(i.BT,{children:"Generates a recommendation based on the customer's profile and LATEST measurements. The more details provided, the better the recommendation."})]}),(0,t.jsxs)(i.Wu,{children:[(0,t.jsx)(d.$,{onClick:m,disabled:r,children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):"Generate Recommendation"}),s&&(0,t.jsxs)("div",{className:"mt-6 p-4 bg-secondary rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-headline text-lg mb-2",children:"Recommendation:"}),(0,t.jsx)("p",{className:"text-sm font-body whitespace-pre-wrap",children:s})]})]})]})}var R=s(2278),A=s(9434);let D=R.bL,k=R.l9,z=R.ZL,P=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(R.hJ,{className:(0,A.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:a})});P.displayName=R.hJ.displayName;let L=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsxs)(z,{children:[(0,t.jsx)(P,{}),(0,t.jsx)(R.UC,{ref:a,className:(0,A.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l})]})});L.displayName=R.UC.displayName;let U=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,A.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...s})};U.displayName="AlertDialogHeader";let I=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,A.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};I.displayName="AlertDialogFooter";let J=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(R.hE,{ref:a,className:(0,A.cn)("text-lg font-semibold",s),...l})});J.displayName=R.hE.displayName;let Z=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(R.VY,{ref:a,className:(0,A.cn)("text-sm text-muted-foreground",s),...l})});Z.displayName=R.VY.displayName;let M=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(R.rc,{ref:a,className:(0,A.cn)((0,d.r)(),s),...l})});M.displayName=R.rc.displayName;let B=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(R.ZD,{ref:a,className:(0,A.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",s),...l})});B.displayName=R.ZD.displayName;var O=s(5582),H=s(3158),T=s(518),W=s(154);let q=O.bL,V=O.l9;O.YJ,O.ZL,O.Pb,O.z6,n.forwardRef((e,a)=>{let{className:s,inset:l,children:r,...n}=e;return(0,t.jsxs)(O.ZP,{ref:a,className:(0,A.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",s),...n,children:[r,(0,t.jsx)(H.A,{className:"ml-auto"})]})}).displayName=O.ZP.displayName,n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(O.G5,{ref:a,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})}).displayName=O.G5.displayName;let E=n.forwardRef((e,a)=>{let{className:s,sideOffset:l=4,...r}=e;return(0,t.jsx)(O.ZL,{children:(0,t.jsx)(O.UC,{ref:a,sideOffset:l,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})})});E.displayName=O.UC.displayName;let _=n.forwardRef((e,a)=>{let{className:s,inset:l,...r}=e;return(0,t.jsx)(O.q7,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",s),...r})});_.displayName=O.q7.displayName,n.forwardRef((e,a)=>{let{className:s,children:l,checked:r,...n}=e;return(0,t.jsxs)(O.H_,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:r,...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(O.VF,{children:(0,t.jsx)(T.A,{className:"h-4 w-4"})})}),l]})}).displayName=O.H_.displayName,n.forwardRef((e,a)=>{let{className:s,children:l,...r}=e;return(0,t.jsxs)(O.hN,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(O.VF,{children:(0,t.jsx)(W.A,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=O.hN.displayName,n.forwardRef((e,a)=>{let{className:s,inset:l,...r}=e;return(0,t.jsx)(O.JU,{ref:a,className:(0,A.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",s),...r})}).displayName=O.JU.displayName,n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(O.wv,{ref:a,className:(0,A.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=O.wv.displayName;var $=s(7250);let F=$.bL,Y=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)($.q7,{ref:a,className:(0,A.cn)("border-b",s),...l})});Y.displayName="AccordionItem";let G=n.forwardRef((e,a)=>{let{className:s,children:l,...r}=e;return(0,t.jsx)($.Y9,{className:"flex",children:(0,t.jsxs)($.l9,{ref:a,className:(0,A.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...r,children:[l,(0,t.jsx)(b.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});G.displayName=$.l9.displayName;let K=n.forwardRef((e,a)=>{let{className:s,children:l,...r}=e;return(0,t.jsx)($.UC,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,t.jsx)("div",{className:(0,A.cn)("pb-4 pt-0",s),children:l})})});K.displayName=$.UC.displayName;var Q=s(5733),X=s(221),ee=s(2177),ea=s(5594),es=s(7759),et=s(2523),el=s(9119),er=s(2741);let en=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(er.bL,{className:(0,A.cn)("grid gap-2",s),...l,ref:a})});en.displayName=er.bL.displayName;let ed=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(er.q7,{ref:a,className:(0,A.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...l,children:(0,t.jsx)(er.C1,{className:"flex items-center justify-center",children:(0,t.jsx)(W.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});ed.displayName=er.q7.displayName;var ei=s(7489);let eo=n.forwardRef((e,a)=>{let{className:s,orientation:l="horizontal",decorative:r=!0,...n}=e;return(0,t.jsx)(ei.b,{ref:a,decorative:r,orientation:l,className:(0,A.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",s),...n})});eo.displayName=ei.b.displayName;let ec=ea.z.object({jobNumber:ea.z.string().optional(),requestDate:ea.z.string().optional(),paymentStatus:ea.z.enum(["Paid","Pending","Unpaid"]),measurements:ea.z.array(ea.z.object({label:ea.z.string().min(1,"Label is required."),value:ea.z.coerce.number().min(0,"Value cannot be negative.")})).min(1,"At least one measurement is required.")}),em=[{label:"Height",value:0},{label:"Neck Width",value:0},{label:"Shoulder",value:0},{label:"Armhole Curve",value:0},{label:"Upperarm Width",value:0},{label:"Chest",value:0},{label:"Underbust",value:0},{label:"Nipple to Nipple",value:0},{label:"Waist",value:0},{label:"Hips",value:0},{label:"Waist to Knee Length",value:0},{label:"Waist to Ankle",value:0},{label:"Thigh Circ",value:0},{label:"Ankle Circ",value:0},{label:"Shoulder to Waist",value:0},{label:"Shoulder to Ankle",value:0},{label:"Shoulder to Wrist",value:0},{label:"Shoulder to Elbow",value:0},{label:"Inner Arm Length",value:0},{label:"Outseam Length",value:0},{label:"Inseam Length",value:0},{label:"Back Rise",value:0},{label:"Front Rise",value:0},{label:"Single Shoulder",value:0},{label:"Front Drop",value:0},{label:"Back Drop",value:0},{label:"Armhole Curve Straight",value:0},{label:"Neck Band Width",value:0},{label:"Collar Width",value:0},{label:"Collar Point",value:0},{label:"Sleeve Length",value:0},{label:"Sleeve Open",value:0},{label:"Cuff Height",value:0},{label:"Waist Band",value:0},{label:"Leg Open",value:0},{label:"Seat Length",value:0}];function ex(e){let{onSave:a}=e,s=(0,ee.mN)({resolver:(0,X.u)(ec),defaultValues:{jobNumber:"",requestDate:new Date().toISOString().split("T")[0],paymentStatus:"Pending",measurements:em}}),{fields:l,append:r,remove:n}=(0,ee.jz)({control:s.control,name:"measurements"});return(0,t.jsx)(es.lV,{...s,children:(0,t.jsxs)("form",{onSubmit:s.handleSubmit(function(e){a({id:crypto.randomUUID(),date:new Date().toISOString(),measurements:e.measurements,jobNumber:e.jobNumber,requestDate:e.requestDate,paymentStatus:e.paymentStatus,orderStatus:"In Progress"})}),className:"space-y-6",children:[(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsx)(i.ZB,{className:"font-headline text-2xl",children:"Job Details"})}),(0,t.jsxs)(i.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(es.zB,{control:s.control,name:"jobNumber",render:e=>{var a;let{field:s}=e;return(0,t.jsxs)(es.eI,{children:[(0,t.jsx)(es.lR,{children:"Job Number"}),(0,t.jsx)(es.MJ,{children:(0,t.jsx)(et.p,{placeholder:"e.g., A-124",...s,value:null!=(a=s.value)?a:""})}),(0,t.jsx)(es.C5,{})]})}}),(0,t.jsx)(es.zB,{control:s.control,name:"requestDate",render:e=>{var a;let{field:s}=e;return(0,t.jsxs)(es.eI,{children:[(0,t.jsx)(es.lR,{children:"Request Date"}),(0,t.jsx)(es.MJ,{children:(0,t.jsx)(et.p,{type:"date",...s,value:null!=(a=s.value)?a:""})}),(0,t.jsx)(es.C5,{})]})}})]}),(0,t.jsx)(es.zB,{control:s.control,name:"paymentStatus",render:e=>{let{field:a}=e;return(0,t.jsxs)(es.eI,{className:"space-y-3",children:[(0,t.jsx)(es.lR,{children:"Payment Status"}),(0,t.jsx)(es.MJ,{children:(0,t.jsxs)(en,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-6",children:[(0,t.jsxs)(es.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(es.MJ,{children:(0,t.jsx)(ed,{value:"Pending"})}),(0,t.jsx)(es.lR,{className:"font-normal",children:"Pending"})]}),(0,t.jsxs)(es.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(es.MJ,{children:(0,t.jsx)(ed,{value:"Paid"})}),(0,t.jsx)(es.lR,{className:"font-normal",children:"Paid"})]}),(0,t.jsxs)(es.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(es.MJ,{children:(0,t.jsx)(ed,{value:"Unpaid"})}),(0,t.jsx)(es.lR,{className:"font-normal",children:"Unpaid"})]})]})}),(0,t.jsx)(es.C5,{})]})}})]})]}),(0,t.jsx)(eo,{}),(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{className:"font-headline text-2xl",children:"Measurements"}),(0,t.jsx)(i.BT,{children:"All measurements should be in inches. This set will be dated today."})]}),(0,t.jsxs)(i.Wu,{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 max-h-[40vh] overflow-y-auto p-4 border rounded-md",children:[l.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-end gap-2",children:[(0,t.jsx)(es.zB,{control:s.control,name:"measurements.".concat(a,".label"),render:e=>{let{field:a}=e;return(0,t.jsxs)(es.eI,{className:"flex-1",children:[(0,t.jsx)(es.lR,{className:"text-xs",children:"Type"}),(0,t.jsx)(es.MJ,{children:(0,t.jsx)(et.p,{placeholder:"e.g., Shoulder",...a})}),(0,t.jsx)(es.C5,{})]})}}),(0,t.jsx)(es.zB,{control:s.control,name:"measurements.".concat(a,".value"),render:e=>{let{field:a}=e;return(0,t.jsxs)(es.eI,{className:"w-24",children:[(0,t.jsx)(es.lR,{className:"text-xs",children:"Value (in)"}),(0,t.jsx)(es.MJ,{children:(0,t.jsx)(et.p,{type:"number",step:"0.1",placeholder:"e.g., 16.5",...a})}),(0,t.jsx)(es.C5,{})]})}}),(0,t.jsxs)(d.$,{type:"button",variant:"destructive",size:"icon",onClick:()=>n(a),children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Remove measurement"})]})]},e.id)),(0,t.jsxs)(d.$,{type:"button",variant:"outline",size:"sm",className:"mt-2 md:col-span-2",onClick:()=>r({label:"",value:0}),children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Add Measurement"]})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(d.$,{type:"submit",size:"lg",children:[(0,t.jsx)(el.A,{className:"mr-2 h-4 w-4"}),"Save Measurement Set"]})})]})})}var eu=s(5821),ep=s(5318);let eh=eu.bL,ef=eu.l9,ej=eu.ZL;eu.bm;let eN=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(eu.hJ,{ref:a,className:(0,A.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l})});eN.displayName=eu.hJ.displayName;let eg=n.forwardRef((e,a)=>{let{className:s,children:l,...r}=e;return(0,t.jsxs)(ej,{children:[(0,t.jsx)(eN,{}),(0,t.jsxs)(eu.UC,{ref:a,className:(0,A.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[l,(0,t.jsxs)(eu.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(ep.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eg.displayName=eu.UC.displayName;let eb=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,A.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};eb.displayName="DialogHeader";let ev=n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(eu.hE,{ref:a,className:(0,A.cn)("text-lg font-semibold leading-none tracking-tight",s),...l})});ev.displayName=eu.hE.displayName,n.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(eu.VY,{ref:a,className:(0,A.cn)("text-sm text-muted-foreground",s),...l})}).displayName=eu.VY.displayName;let ey=(0,s(2085).F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ew(e){let{className:a,variant:s,...l}=e;return(0,t.jsx)("div",{className:(0,A.cn)(ey({variant:s}),a),...l})}function eS(){let e=(0,r.useParams)(),a=(0,r.useRouter)(),{toast:s}=(0,S.dj)(),[v,y]=(0,l.M)("customers",[]),[w,R]=(0,n.useState)(null),[A,z]=(0,n.useState)(!1),[P,O]=(0,n.useState)(!1),[H,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>{z(!0)},[]),(0,n.useEffect)(()=>{if(A){let a=v.find(a=>a.id===e.id);a&&R(a)}},[e.id,v,A]);let W=(e,a)=>{if(!w)return;let t=w.measurementSets.map(s=>{if(s.id===e){let e={...s,orderStatus:a};return"Completed"===a?e.completionDate=new Date().toISOString():"Handed Over"===a&&(e.handoverDate=new Date().toISOString()),e}return s}),l={...w,measurementSets:t};y(v.map(e=>e.id===w.id?l:e)),R(l),s({title:"Order Status Updated!",description:"The job has been marked as ".concat(a,".")})},$=(e,a)=>{if(!w)return;let t=w.measurementSets.map(s=>s.id===e?{...s,paymentStatus:a}:s),l={...w,measurementSets:t};y(v.map(e=>e.id===w.id?l:e)),R(l),s({title:"Payment Status Updated!",description:"The job's payment has been marked as ".concat(a,".")})};if(!A)return(0,t.jsx)("div",{className:"text-center p-10",children:"Loading customer details..."});if(!w)return(0,t.jsx)("div",{className:"text-center p-10",children:"Customer not found."});let X=w.measurementSets?[...w.measurementSets].sort((e,a)=>new Date(a.date).getTime()-new Date(e.date).getTime()):[],ee=e=>{switch(e){case"Paid":return"default";case"Pending":return"secondary";case"Unpaid":return"destructive";default:return"outline"}},ea=e=>{switch(e){case"Completed":return"default";case"In Progress":return"secondary";case"Handed Over":return"outline"}};return(0,t.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"p-3 bg-primary/10 rounded-full text-primary",children:(0,t.jsx)(o.A,{className:"h-8 w-8"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl lg:text-4xl font-headline font-bold",children:w.name}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Customer Profile"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(eh,{open:P,onOpenChange:O,children:[(0,t.jsx)(ef,{asChild:!0,children:(0,t.jsxs)(d.$,{variant:"outline",children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"})," Edit Profile"]})}),(0,t.jsxs)(eg,{className:"sm:max-w-[800px]",children:[(0,t.jsx)(eb,{children:(0,t.jsxs)(ev,{className:"font-headline text-2xl",children:["Edit ",w.name]})}),(0,t.jsx)("div",{className:"max-h-[70vh] overflow-y-auto p-1",children:(0,t.jsx)(Q.CustomerForm,{customer:w,onSave:()=>{O(!1)}})})]})]}),(0,t.jsxs)(D,{children:[(0,t.jsx)(k,{asChild:!0,children:(0,t.jsxs)(d.$,{variant:"destructive",children:[(0,t.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Delete"]})}),(0,t.jsxs)(L,{children:[(0,t.jsxs)(U,{children:[(0,t.jsx)(J,{children:"Are you absolutely sure?"}),(0,t.jsxs)(Z,{children:["This action cannot be undone. This will permanently delete ",w.name,"'s profile and all their associated data."]})]}),(0,t.jsxs)(I,{children:[(0,t.jsx)(B,{children:"Cancel"}),(0,t.jsx)(M,{onClick:()=>{y(v.filter(a=>a.id!==e.id)),s({title:"Customer Deleted",description:"".concat(null==w?void 0:w.name," has been removed from your records.")}),a.push("/dashboard")},children:"Continue"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(i.Zp,{className:"lg:col-span-1",children:[(0,t.jsx)(i.aR,{children:(0,t.jsx)(i.ZB,{className:"font-headline",children:"Contact Info"})}),(0,t.jsxs)(i.Wu,{className:"space-y-3 text-sm",children:[(0,t.jsxs)("p",{className:"flex items-start gap-3",children:[(0,t.jsx)(x.A,{className:"h-5 w-5 mt-0.5 text-accent"})," ",(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"NIC:"})," ",w.nic]})]}),(0,t.jsxs)("p",{className:"flex items-start gap-3",children:[(0,t.jsx)(u.A,{className:"h-5 w-5 mt-0.5 text-accent"})," ",(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"Contact:"})," ",w.contact]})]}),(0,t.jsxs)("p",{className:"flex items-start gap-3",children:[(0,t.jsx)(p.A,{className:"h-5 w-5 mt-0.5 text-accent"})," ",(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"Member Since:"})," ",new Date(w.createdAt).toLocaleDateString()]})]})]})]}),(0,t.jsxs)(i.Zp,{className:"md:col-span-2",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(i.ZB,{className:"font-headline",children:"Job History"}),(0,t.jsxs)(eh,{open:H,onOpenChange:T,children:[(0,t.jsx)(ef,{asChild:!0,children:(0,t.jsxs)(d.$,{size:"sm",children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Add New Job"]})}),(0,t.jsxs)(eg,{className:"sm:max-w-4xl",children:[(0,t.jsx)(eb,{children:(0,t.jsxs)(ev,{className:"font-headline text-2xl",children:["Add New Job & Measurements for ",w.name]})}),(0,t.jsx)("div",{className:"max-h-[80vh] overflow-y-auto p-1 pr-2",children:(0,t.jsx)(ex,{onSave:e=>{if(!w)return;let a={...w,measurementSets:[...w.measurementSets||[],e]};y(v.map(e=>e.id===w.id?a:e)),R(a),s({title:"Measurements Added!",description:"A new set of measurements has been saved for ".concat(w.name,".")}),T(!1)}})})]})]})]}),(0,t.jsx)(i.BT,{children:"View measurement and job history. Each entry is dated."})]}),(0,t.jsx)(i.Wu,{children:X.length>0?(0,t.jsx)(F,{type:"single",collapsible:!0,defaultValue:"item-0",className:"w-full",children:X.map((e,a)=>(0,t.jsxs)(Y,{value:"item-".concat(a),children:[(0,t.jsxs)(G,{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center text-left gap-x-4 gap-y-1",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.jobNumber||"Job from ".concat(new Date(e.date).toLocaleDateString())}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.requestDate?"Requested: ".concat(new Date(e.requestDate).toLocaleDateString()):""})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 ml-auto pl-4 flex-wrap justify-end",children:[(0,t.jsx)(ew,{variant:ea(e.orderStatus),children:e.orderStatus}),(0,t.jsx)(ew,{variant:ee(e.paymentStatus),children:e.paymentStatus}),0===a&&(0,t.jsx)(ew,{variant:"outline",className:"shrink-0 bg-primary/10 text-primary border-primary/20 font-normal",children:"Latest"})]})]}),(0,t.jsx)(K,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 text-sm pt-2",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.A,{className:"w-4 h-4 text-accent"}),(0,t.jsx)("span",{className:"font-semibold",children:"Job Number:"})," ",e.jobNumber||"N/A"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"w-4 h-4 text-accent"}),(0,t.jsx)("span",{className:"font-semibold",children:"Payment:"}),(0,t.jsx)(ew,{variant:ee(e.paymentStatus),children:e.paymentStatus})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 text-muted-foreground",children:[e.completionDate&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.A,{className:"w-4 h-4 text-accent"}),(0,t.jsxs)("span",{children:["Completed: ",new Date(e.completionDate).toLocaleDateString()]})]}),e.handoverDate&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"w-4 h-4 text-accent"}),(0,t.jsxs)("span",{children:["Handed Over: ",new Date(e.handoverDate).toLocaleDateString()]})]})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 pt-2",children:e.measurements.map(e=>(0,t.jsxs)("div",{className:"p-3 bg-secondary rounded-lg text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.label}),(0,t.jsx)("p",{className:"text-lg font-semibold text-primary",children:e.value})]},e.label))}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-3 mt-4 pt-4 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-semibold",children:"Order Status:"}),(0,t.jsxs)(q,{children:[(0,t.jsx)(V,{asChild:!0,children:(0,t.jsxs)(d.$,{variant:"outline",size:"sm",children:["Update ",(0,t.jsx)(b.A,{className:"ml-2 h-4 w-4"})]})}),(0,t.jsxs)(E,{children:[(0,t.jsx)(_,{onClick:()=>W(e.id,"In Progress"),children:"In Progress"}),(0,t.jsx)(_,{onClick:()=>W(e.id,"Completed"),children:"Completed"}),(0,t.jsx)(_,{onClick:()=>W(e.id,"Handed Over"),children:"Handed Over"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-semibold",children:"Payment:"}),(0,t.jsxs)(q,{children:[(0,t.jsx)(V,{asChild:!0,children:(0,t.jsxs)(d.$,{variant:"outline",size:"sm",children:["Update ",(0,t.jsx)(b.A,{className:"ml-2 h-4 w-4"})]})}),(0,t.jsxs)(E,{children:[(0,t.jsx)(_,{onClick:()=>$(e.id,"Paid"),children:"Mark as Paid"}),(0,t.jsx)(_,{onClick:()=>$(e.id,"Pending"),children:"Mark as Pending"}),(0,t.jsx)(_,{onClick:()=>$(e.id,"Unpaid"),children:"Mark as Unpaid"})]})]})]})]})]})})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-10 border-2 border-dashed rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No jobs or measurements recorded yet."}),(0,t.jsxs)(d.$,{size:"sm",className:"mt-4",onClick:()=>T(!0),children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Add Job & Measurements"]})]})})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsx)(i.ZB,{className:"font-headline",children:"Order History"})}),(0,t.jsx)(i.Wu,{children:(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:w.orderHistory||"No history recorded."})})]}),(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsx)(i.ZB,{className:"font-headline",children:"Style Preferences"})}),(0,t.jsx)(i.Wu,{children:(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:w.preferences||"No preferences recorded."})})]})]}),(0,t.jsx)(C,{customer:w})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[3,476,240,353,733,441,684,358],()=>a(2041)),_N_E=e.O()}]);